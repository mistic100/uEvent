{"version":3,"file":"browser.js","sources":["src/Event.js","src/EventEmitter.js","index.js"],"sourcesContent":["const returnTrue = () => {\n    return true;\n};\n\nconst returnFalse = () => {\n    return false;\n};\n\nclass Event {\n\n    /**\n     * @param {*} target\n     * @param {String} type\n     * @param {Array} args\n     */\n    constructor(target, type, args) {\n        Object.defineProperties(this, {\n            'target': {\n                get       : () => {\n                    return target;\n                },\n                set       : () => {},\n                enumerable: true\n            },\n            'type'  : {\n                get       : () => {\n                    return type;\n                },\n                set       : () => {},\n                enumerable: true\n            },\n            'args'  : {\n                get       : () => {\n                    return args;\n                },\n                set       : () => {},\n                enumerable: true\n            }\n        });\n\n        this.isDefaultPrevented = returnFalse;\n        this.isPropagationStopped = returnFalse;\n    }\n\n    preventDefault() {\n        this.isDefaultPrevented = returnTrue;\n    }\n\n    stopPropagation() {\n        this.isPropagationStopped = returnTrue;\n    }\n\n}\n\nmodule.exports = Event;\n","const Event = require('./Event');\n\n/**\n * @typedef {Object.<String, Function>} Callbacks\n */\n\nclass EventEmitter {\n\n    /**\n     * Add one or many event handlers\n     *\n     * @example\n     *  obj.on('event', callback)\n     *  obj.on('event', listener) // listener has an `handleEvent` method\n     *  obj.on('event1 event2', callback)\n     *  obj.on({ event1: callback1, event2: callback2 })\n     *\n     * @param {String|Callbacks} events\n     * @param {Function} [callback]\n     * @return {this}\n     */\n    on(events, callback, once = false) {\n        this.__events = this.__events || {};\n\n        if (typeof events === 'object') {\n            for (const event in events) {\n                if (events.hasOwnProperty(event)) {\n                    if (once) {\n                        events[event].__once = true;\n                    }\n                    this.__events[event] = this.__events[event] || [];\n                    this.__events[event].push(events[event]);\n                }\n            }\n        }\n        else {\n            if (once) {\n                callback.__once = true;\n            }\n            events.split(' ').forEach((event) => {\n                this.__events[event] = this.__events[event] || [];\n                this.__events[event].push(callback);\n            });\n        }\n\n        return this;\n    }\n\n    /**\n     * Remove one or many or all event handlers\n     *\n     * @example\n     *  obj.off('event')\n     *  obj.off('event', callback)\n     *  obj.off('event1 event2')\n     *  obj.off({ event1: callback1, event2: callback2 })\n     *  obj.off()\n     *\n     * @param {String|Callbacks} [events]\n     * @param {Function} [callback]\n     * @return {this}\n     */\n    off(events, callback) {\n        this.__events = this.__events || {};\n\n        if (typeof events === 'object') {\n            for (const event in events) {\n                if (events.hasOwnProperty(event) && (event in this.__events)) {\n                    const index = this.__events[event].indexOf(events[event]);\n                    if (index !== -1) this.__events[event].splice(index, 1);\n                }\n            }\n        }\n        else if (!!events) {\n            events.split(' ').forEach((event) => {\n                if (event in this.__events) {\n                    if (callback) {\n                        const index = this.__events[event].indexOf(callback);\n                        if (index !== -1) this.__events[event].splice(index, 1);\n                    }\n                    else {\n                        this.__events[event].length = 0;\n                    }\n                }\n            });\n        }\n        else {\n            this.__events = {};\n        }\n\n        return this;\n    }\n\n    /**\n     * Add one or many event handlers that will be called only once\n     * This handlers are only applicable to \"trigger\", not \"change\"\n     *\n     * @example\n     *  obj.once('event', callback)\n     *  obj.once('event1 event2', callback)\n     *  obj.once({ event1: callback1, event2: callback2 })\n     *\n     * @param {String|Callbacks} events\n     * @param {Function} [callback]\n     * @return {this}\n     */\n    once(events, callback) {\n        return this.on(events, callback, true);\n    }\n\n    /**\n     * Trigger all handlers for an event\n     *\n     * @param {String} event\n     * @param {*...} [arguments]\n     * @return {Event}\n     */\n    trigger(event /* , args... */) {\n        const args = Array.prototype.slice.call(arguments, 1);\n        const e = new Event(this, event, args);\n\n        if (this.__events && event in this.__events) {\n            let hasOnce = false;\n            for (let i = 0, l = this.__events[event].length; i < l; i++) {\n                let f = this.__events[event][i];\n                if (f.__once) {\n                    hasOnce = true;\n                }\n                if (typeof f === 'object') {\n                    f.handleEvent(e);\n                }\n                else {\n                    f.call(this, e, ...args);\n                }\n                if (e.isPropagationStopped()) {\n                    break;\n                }\n            }\n            if (hasOnce) {\n                this.__events[event] = this.__events[event].filter(f => !f.__once);\n            }\n        }\n\n        return e;\n    }\n\n    /**\n     * Trigger all modificators for an event, each handler must return a value\n     *\n     * @param {String} event\n     * @param {*} value\n     * @param {*...} [arguments]\n     * @return {*} modified value\n     */\n    change(event, value /* , args... */) {\n        const args = Array.prototype.slice.call(arguments, 2);\n        const e = new Event(this, event, args);\n        e.value = value;\n\n        if (this.__events && event in this.__events) {\n            for (let i = 0, l = this.__events[event].length; i < l; i++) {\n                const f = this.__events[event][i];\n                if (f.__once) {\n                    continue;\n                }\n                if (typeof f === 'object') {\n                    e.value = f.handleEvent(e);\n                }\n                else {\n                    e.value = f.call(this, e, e.value, ...args);\n                }\n                if (e.isPropagationStopped()) {\n                    break;\n                }\n            }\n        }\n\n        return e.value;\n    }\n\n}\n\nmodule.exports = EventEmitter;\n","const EventEmitter = require('./src/EventEmitter');\nconst Event = require('./src/Event');\n\nfunction mixin(target) {\n    target = typeof target === 'function' ? target.prototype : target;\n\n    ['on', 'off', 'once', 'trigger', 'change'].forEach((name) => {\n        target[name] = EventEmitter.prototype[name];\n    });\n\n    return target;\n}\n\nmodule.exports = {\n    EventEmitter: EventEmitter,\n    Event       : Event,\n    mixin       : mixin,\n};\n"],"names":["returnTrue","returnFalse","Event","target","type","args","Object","defineProperties","get","set","enumerable","isDefaultPrevented","isPropagationStopped","preventDefault","stopPropagation","EventEmitter","on","events","callback","once","__events","event","hasOwnProperty","__once","push","split","forEach","off","index","indexOf","splice","length","trigger","Array","prototype","slice","call","arguments","e","hasOnce","i","l","f","handleEvent","filter","change","value","mixin","name"],"mappings":"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"}